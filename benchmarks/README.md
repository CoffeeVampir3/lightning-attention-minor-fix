# Benchmark

## Srmsnorm
Speed benchmark:
```
srms-speed_fwd-batch12-dim2048-dtype_bf16:
         n    Triton      Torch
0    512.0  0.040659   0.343820
1   1024.0  0.068261   0.586947
2   2048.0  0.124653   1.125501
3   4096.0  0.236823   2.206192
4   8192.0  0.460920   4.364511
5  16384.0  0.912446   8.696270
6  32768.0  1.818576  17.391590

srms-speed_bwd-batch12-dim2048-dtype_bf16:
         n    Triton      Torch
0    512.0  0.102669   0.745417
1   1024.0  0.186009   1.410213
2   2048.0  0.354364   2.740137
3   4096.0  0.690570   5.398187
4   8192.0  1.363543  10.727495
5  16384.0  2.711788  21.397430
6  32768.0  5.410873  42.791248
```

Memory benchmark:
```
srms-memory_fwd-batch12-dim2048-dtype_bf16:
         n       Triton         Torch
0    512.0    48.023438    192.023438
1   1024.0    96.046875    384.046875
2   2048.0   192.093750    768.093750
3   4096.0   384.187500   1536.187500
4   8192.0   768.375000   3072.375000
5  16384.0  1536.750000   6144.750000
6  32768.0  3073.500000  12289.500000

srms-memory_bwd-batch12-dim2048-dtype_bf16:
         n       Triton         Torch
0    512.0   118.823437    430.823438
1   1024.0   237.646875    861.646875
2   2048.0   475.293750   1723.293750
3   4096.0   950.587500   3446.587500
4   8192.0  1901.175000   6893.175000
5  16384.0  3802.350000  13786.350000
6  32768.0  7604.700000  27572.700000
```

## Lightning2
```
lightning2-speed_fwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n     Triton       Flash    Xformers
0    512.0   0.351782    0.092664    0.125723
1   1024.0   0.600033    0.231678    0.375830
2   2048.0   1.137833    0.748262    1.294125
3   4096.0   2.236332    2.744572    4.825598
4   8192.0   4.462824   10.487619   18.328091
5  16384.0   8.816148   40.497246   72.606529
6  32768.0  17.641855  162.978043  285.161804

lightning2-speed_bwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n     Triton       Flash     Xformers
0    512.0   1.166269    0.396368     0.796550
1   1024.0   2.330066    0.955281     2.023791
2   2048.0   4.648997    2.739009     5.981194
3   4096.0   9.282595    8.892038    19.932423
4   8192.0  18.524307   31.988714    72.275970
5  16384.0  37.076271  120.425346   275.637726
6  32768.0  74.256706  470.944183  1078.135376

lightning2-speed_fwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n       Triton        Flash     Xformers
0    512.0    64.000488    64.250977    64.250488
1   1024.0   128.000488   128.500977   128.500488
2   2048.0   256.000488   257.000977   257.000488
3   4096.0   512.000488   514.000977   514.000488
4   8192.0  1024.000488  1028.000977  1028.000488
5  16384.0  2048.000488  2056.000977  2056.000488
6  32768.0  4096.000488  4112.000977  4112.000488

lightning2-speed_bwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n        Triton         Flash      Xformers
0    512.0    173.600488    206.100977    270.100977
1   1024.0    347.200488    412.200977    540.200977
2   2048.0    694.400488    824.400977   1080.400977
3   4096.0   1388.800488   1648.800977   2160.800977
4   8192.0   2777.600488   3297.600977   4321.600977
5  16384.0   5555.200488   6595.200977   8643.200977
6  32768.0  11110.400488  13190.400977  17286.400977
```
