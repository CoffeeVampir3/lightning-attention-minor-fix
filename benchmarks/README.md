# Benchmark

## Srmsnorm
Speed benchmark:
```
srms-speed-fwd-batch12-dim2048-dtype-fp32:
         n    Triton     Torch
0    512.0  0.068586  0.179694
1   1024.0  0.125072  0.331409
2   2048.0  0.239208  0.629911
3   4096.0  0.467096  1.226275
4   8192.0  0.922794  2.414879
5  16384.0  1.832800  4.807468
6  32768.0  3.666761  9.603680

srms-speed-fwd-batch12-dim2048-dtype-fp16:
         n    Triton      Torch
0    512.0  0.039535   0.311249
1   1024.0  0.067685   0.579972
2   2048.0  0.124639   1.115299
3   4096.0  0.237172   2.182358
4   8192.0  0.462668   4.314230
5  16384.0  0.913525   8.588520
6  32768.0  1.822142  17.194757

srms-speed-fwd-batch12-dim2048-dtype-bf16:
         n    Triton      Torch
0    512.0  0.038983   0.312859
1   1024.0  0.068253   0.585825
2   2048.0  0.124122   1.126759
3   4096.0  0.236881   2.205698
4   8192.0  0.461929   4.364794
5  16384.0  0.912410   8.689826
6  32768.0  1.817773  17.393415

srms-speed-bwd-batch12-dim2048-dtype-fp32:
         n     Triton      Torch
0    512.0   0.183950   0.656805
1   1024.0   0.351420   1.243284
2   2048.0   0.687367   2.413164
3   4096.0   1.360572   4.755171
4   8192.0   2.706352   9.448751
5  16384.0   5.397202  18.839725
6  32768.0  10.782196  37.668880

srms-speed-bwd-batch12-dim2048-dtype-fp16:
         n    Triton      Torch
0    512.0  0.102542   0.743632
1   1024.0  0.185588   1.405220
2   2048.0  0.354090   2.728556
3   4096.0  0.690130   5.375518
4   8192.0  1.363537  10.683528
5  16384.0  2.711812  21.291975
6  32768.0  5.403737  42.590576

srms-speed-bwd-batch12-dim2048-dtype-bf16:
         n    Triton      Torch
0    512.0  0.102733   0.746193
1   1024.0  0.185827   1.410401
2   2048.0  0.354251   2.739197
3   4096.0  0.690540   5.399941
4   8192.0  1.363590  10.728697
5  16384.0  2.712665  21.392544
6  32768.0  5.405412  42.789490
```

Memory benchmark:
```
srms-memory-fwd-batch12-dim2048-dtype-fp32:
         n       Triton        Torch
0    512.0    96.023438   144.023438
1   1024.0   192.046875   288.046875
2   2048.0   384.093750   576.093750
3   4096.0   768.187500  1152.187500
4   8192.0  1536.375000  2304.375000
5  16384.0  3072.750000  4608.750000
6  32768.0  6145.500000  9217.500000

srms-memory-fwd-batch12-dim2048-dtype-fp16:
         n       Triton         Torch
0    512.0    48.023438    192.023438
1   1024.0    96.046875    384.046875
2   2048.0   192.093750    768.093750
3   4096.0   384.187500   1536.187500
4   8192.0   768.375000   3072.375000
5  16384.0  1536.750000   6144.750000
6  32768.0  3073.500000  12289.500000

srms-memory-fwd-batch12-dim2048-dtype-bf16:
         n       Triton         Torch
0    512.0    48.023438    192.023438
1   1024.0    96.046875    384.046875
2   2048.0   192.093750    768.093750
3   4096.0   384.187500   1536.187500
4   8192.0   768.375000   3072.375000
5  16384.0  1536.750000   6144.750000
6  32768.0  3073.500000  12289.500000

srms-memory-bwd-batch12-dim2048-dtype-fp32:
         n        Triton         Torch
0    512.0    237.623437    477.623438
1   1024.0    475.246875    955.246875
2   2048.0    950.493750   1910.493750
3   4096.0   1900.987500   3820.987500
4   8192.0   3801.975000   7641.975000
5  16384.0   7603.950000  15283.950000
6  32768.0  15207.900000  30567.900000

srms-memory-bwd-batch12-dim2048-dtype-fp16:
         n       Triton         Torch
0    512.0   118.823437    430.823438
1   1024.0   237.646875    861.646875
2   2048.0   475.293750   1723.293750
3   4096.0   950.587500   3446.587500
4   8192.0  1901.175000   6893.175000
5  16384.0  3802.350000  13786.350000
6  32768.0  7604.700000  27572.700000

srms-memory-bwd-batch12-dim2048-dtype-bf16:
         n       Triton         Torch
0    512.0   118.823437    430.823438
1   1024.0   237.646875    861.646875
2   2048.0   475.293750   1723.293750
3   4096.0   950.587500   3446.587500
4   8192.0  1901.175000   6893.175000
5  16384.0  3802.350000  13786.350000
6  32768.0  7604.700000  27572.700000
```

## Lightning2 with pad
```
lightning2-speed_fwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n     Triton       Flash    Xformers
0    512.0   0.351782    0.092664    0.125723
1   1024.0   0.600033    0.231678    0.375830
2   2048.0   1.137833    0.748262    1.294125
3   4096.0   2.236332    2.744572    4.825598
4   8192.0   4.462824   10.487619   18.328091
5  16384.0   8.816148   40.497246   72.606529
6  32768.0  17.641855  162.978043  285.161804
lightning2-speed_bwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n     Triton       Flash     Xformers
0    512.0   1.166269    0.396368     0.796550
1   1024.0   2.330066    0.955281     2.023791
2   2048.0   4.648997    2.739009     5.981194
3   4096.0   9.282595    8.892038    19.932423
4   8192.0  18.524307   31.988714    72.275970
5  16384.0  37.076271  120.425346   275.637726
6  32768.0  74.256706  470.944183  1078.135376
lightning2-speed_fwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n       Triton        Flash     Xformers
0    512.0    64.000488    64.250977    64.250488
1   1024.0   128.000488   128.500977   128.500488
2   2048.0   256.000488   257.000977   257.000488
3   4096.0   512.000488   514.000977   514.000488
4   8192.0  1024.000488  1028.000977  1028.000488
5  16384.0  2048.000488  2056.000977  2056.000488
6  32768.0  4096.000488  4112.000977  4112.000488
lightning2-speed_bwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n        Triton         Flash      Xformers
0    512.0    173.600488    206.100977    270.100977
1   1024.0    347.200488    412.200977    540.200977
2   2048.0    694.400488    824.400977   1080.400977
3   4096.0   1388.800488   1648.800977   2160.800977
4   8192.0   2777.600488   3297.600977   4321.600977
5  16384.0   5555.200488   6595.200977   8643.200977
6  32768.0  11110.400488  13190.400977  17286.400977
```
