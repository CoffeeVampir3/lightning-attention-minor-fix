# Benchmark

## Srmsnorm
Speed benchmark:
```
srms-speed_fwd-batch12-dim2048-dtype_bf16:
         n    Triton      Torch
0    512.0  0.040659   0.343820
1   1024.0  0.068261   0.586947
2   2048.0  0.124653   1.125501
3   4096.0  0.236823   2.206192
4   8192.0  0.460920   4.364511
5  16384.0  0.912446   8.696270
6  32768.0  1.818576  17.391590

srms-speed_bwd-batch12-dim2048-dtype_bf16:
         n    Triton      Torch
0    512.0  0.102669   0.745417
1   1024.0  0.186009   1.410213
2   2048.0  0.354364   2.740137
3   4096.0  0.690570   5.398187
4   8192.0  1.363543  10.727495
5  16384.0  2.711788  21.397430
6  32768.0  5.410873  42.791248
```

Memory benchmark:
```
srms-memory_fwd-batch12-dim2048-dtype_bf16:
         n       Triton         Torch
0    512.0    48.023438    192.023438
1   1024.0    96.046875    384.046875
2   2048.0   192.093750    768.093750
3   4096.0   384.187500   1536.187500
4   8192.0   768.375000   3072.375000
5  16384.0  1536.750000   6144.750000
6  32768.0  3073.500000  12289.500000

srms-memory_bwd-batch12-dim2048-dtype_bf16:
         n       Triton         Torch
0    512.0   118.823437    430.823438
1   1024.0   237.646875    861.646875
2   2048.0   475.293750   1723.293750
3   4096.0   950.587500   3446.587500
4   8192.0  1901.175000   6893.175000
5  16384.0  3802.350000  13786.350000
6  32768.0  7604.700000  27572.700000
```

## Lightning2
```
lightning2-speed_fwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n  Lightning2  Lightning2NoDecay      Flash2    Xformers
0    512.0    0.350865           0.416118    0.092741    0.125679
1   1024.0    0.593411           0.758793    0.230676    0.374029
2   2048.0    1.160422           1.477481    0.740248    1.288270
3   4096.0    2.270973           2.949107    2.708734    4.734572
4   8192.0    4.536520           6.018426   10.314713   18.246317
5  16384.0    8.872131          11.795692   40.102528   71.208992
6  32768.0   17.834457          23.883759  161.154434  284.535034
lightning2-speed_bwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n  Lightning2  Lightning2NoDecay      Flash2     Xformers
0    512.0    1.166243           1.378255    0.403119     0.795477
1   1024.0    2.315413           2.653988    0.956182     2.023189
2   2048.0    4.626652           5.504418    2.732708     5.966718
3   4096.0    9.246017          11.009040    8.840032    19.891224
4   8192.0   18.486534          21.968288   31.451384    71.964386
5  16384.0   36.949631          36.816639  119.492577   273.240295
6  32768.0   74.123329          73.657219  463.624054  1068.031128
lightning2-memory_fwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n   Lightning2  Lightning2NoDecay       Flash2     Xformers
0    512.0    64.250488          64.000488    64.250488    64.250488
1   1024.0   128.500488         128.000488   128.500488   128.500488
2   2048.0   257.000488         256.000488   257.000488   257.000488
3   4096.0   514.000488         512.000488   514.000488   514.000488
4   8192.0  1028.000488        1024.000488  1028.000488  1028.000488
5  16384.0  2056.000488        2048.000488  2056.000488  2056.000488
6  32768.0  4112.000488        4096.000488  4112.000488  4112.000488
lightning2-memory_bwd-batch4-head32-qk_dim128-v_dim128-dtype_bf16:
         n    Lightning2  Lightning2NoDecay        Flash2      Xformers
0    512.0    270.100977         173.600488    270.100977    270.100977
1   1024.0    540.200977         347.200488    540.200977    540.200977
2   2048.0   1080.400977         694.400488   1080.400977   1080.400977
3   4096.0   2160.800977        1388.800488   2160.800977   2160.800977
4   8192.0   4321.600977        2777.600488   4321.600977   4321.600977
5  16384.0   8643.200977        5555.200488   8643.200977   8643.200977
6  32768.0  17286.400977       11110.400488  17286.400977  17286.400977
```
